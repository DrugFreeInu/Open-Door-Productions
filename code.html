<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>DFI Backstage Code â€” Shadow-Proof</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background: #000;
  }

  /* Host lives behind everything */
  #dfi-code-host{
    position: fixed;
    inset: 0;
    z-index: 0;
    pointer-events: none;
    overflow: hidden;
    background: #000;
  }

  /* Your real content sits above */
  .content{
    position: relative;
    z-index: 1;
    min-height: 100vh;
  }
</style>
</head>

<body>
  <!-- BACKGROUND CODE HOST -->
  <div id="dfi-code-host" aria-hidden="true"></div>

  <!-- YOUR CONTENT ABOVE -->
  <div class="content">
    <!-- your site / pan scene / snow / etc -->
  </div>

<script>
(() => {
  const host = document.getElementById("dfi-code-host");

  // Shadow DOM: prevents your site CSS from touching the code lines
  const shadow = host.attachShadow({ mode: "open" });

  shadow.innerHTML = `
    <style>
      :host{ all: initial; }
      .layer{
        position: absolute;
        inset: 0;
        overflow: hidden;
        pointer-events: none;
        background: transparent;
      }

      .line{
        position: absolute !important;
        left: 0;
        top: 0;

        display: block;
        white-space: nowrap !important;
        word-break: normal !important;
        overflow-wrap: normal !important;

        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
        color: rgba(235, 245, 255, 0.92);
        text-shadow:
          0 0 6px rgba(180, 210, 255, 0.60),
          0 0 16px rgba(120, 170, 255, 0.35);

        opacity: 0;
        will-change: transform, opacity;
        transform: translateX(0);
        animation: drift linear infinite;
      }

      @keyframes drift{
        0%   { transform: translateX(0); opacity: 0; }
        10%  { opacity: 0.95; }
        90%  { opacity: 0.95; }
        100% { transform: translateX(var(--travel, 1600px)); opacity: 0; }
      }
    </style>
    <div class="layer" id="layer"></div>
  `;

  const layer = shadow.getElementById("layer");

  const snippets = [
    "requestAnimationFrame(loop)",
    "translateX(sceneX)",
    "ctx.clearRect(0,0,w,h)",
    "will-change: transform;",
    "pointer-events: none;",
    "overflow: hidden;",
    "let particles = []",
    "if (y > h) reset()",
    "z-index: 0;",
    "scene !== world",
    "backstage === true",
    "this is not reality",
    "render before meaning",
    "the door is open"
  ];

  function rectSafe(){
    const r = host.getBoundingClientRect();
    const w = Math.max(1, r.width || window.innerWidth);
    const h = Math.max(1, r.height || window.innerHeight);
    return { w, h };
  }

  function spawn(){
    const { w, h } = rectSafe();

    const el = document.createElement("div");
    el.className = "line";
    el.textContent = snippets[(Math.random() * snippets.length) | 0];

    // Explicit scatter (px) so nothing can collapse to top-left
    el.style.top  = Math.floor(Math.random() * Math.max(1, h - 24)) + "px";
    el.style.left = (-120 - Math.random() * 300) + "px"; // off-screen start

    // Travel distance in px (not vw) so it works in any layout
    el.style.setProperty("--travel", (w + 600) + "px");

    // Brighter + readable size
    el.style.fontSize = (12 + Math.random() * 10) + "px";

    // Speed + desync
    el.style.animationDuration = (10 + Math.random() * 18) + "s";
    el.style.animationDelay = (-Math.random() * 8) + "s";

    layer.appendChild(el);
    setTimeout(() => el.remove(), 36000);
  }

  // Kickstart so it doesn't look empty
  for (let i = 0; i < 18; i++) spawn();

  // Density (lower = more lines)
  setInterval(spawn, 170);
})();
</script>
</body>
</html>
